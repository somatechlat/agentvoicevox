<p align="center">
  <img src="https://raw.githubusercontent.com/OpenVoiceOS/ovos-media/main/logos/ovos-logo.png" alt="AgentVoiceVox Logo" width="200"/>
</p>

<h1 align="center">AgentVoiceVox</h1>

<p align="center">
  <strong>Django-based Voice AI Platform</strong>
</p>

---

## What is AgentVoiceVox?

AgentVoiceVox is a self-hosted voice platform built on Django, Django Ninja (REST), and Django Channels (WebSockets). It provides a multi-tenant backend, a portal frontend, and real-time WebSocket endpoints for voice session workflows.

This repository is the source of truth for the Django stack. OpenAI-compatible `/v1` endpoints are not implemented in this codebase; the active API surface is `/api/v2`.

## Architecture (Current)

```
┌─────────────────────────────────────────────────────────────────┐
│                        Portal Frontend                          │
│                    (Lit 3 + Bun 1.3.5, port 65027)               │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         Django API                              │
│          REST: /api/v2/*  ·  WS: /ws/v2/*                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│   Postgres · Redis · Keycloak · Vault · OPA · Lago               │
└─────────────────────────────────────────────────────────────────┘
```

## Key Components

- **Django REST API (Ninja)**: `/api/v2/*`
- **WebSockets (Channels)**: `/ws/v2/*`
- **Backend Runtime**: Python 3.12
- **Portal Frontend**: Lit 3 + Bun 1.3.5 app under `portal-frontend/`
- **Workers**: LLM, STT (faster-whisper), TTS (Kokoro ONNX) in `workers/`

## Quick Start (Docker)

```bash
cd ovos-voice-agent/AgentVoiceBoxEngine

docker compose -p agentvoicebox up -d
```

### Service URLs

| Service | URL |
|---------|-----|
| Portal Frontend | http://localhost:65027 |
| Django API | http://localhost:65020/api/v2 |
| API Docs (Ninja) | http://localhost:65020/api/v2/docs |
| WebSockets | ws://localhost:65020/ws/v2/... |
| Keycloak | http://localhost:65006 |
| Prometheus | http://localhost:65011 |

## WebSocket Endpoints

Defined in `backend/realtime/routing.py`:

- `ws://localhost:65020/ws/v2/events`
- `ws://localhost:65020/ws/v2/sessions/{session_id}`
- `ws://localhost:65020/ws/v2/stt/transcription`
- `ws://localhost:65020/ws/v2/tts/stream`

Auth uses Keycloak JWTs (token via `?token=` or `Authorization: Bearer`).

## Local Development

See `docs/LOCAL_DEVELOPMENT.md` for environment setup, services, and testing.

## API Reference

The authoritative REST API reference is generated by Django Ninja at:

`http://localhost:65020/api/v2/docs`

The static specs in `docs/` describe the current endpoint surfaces.
