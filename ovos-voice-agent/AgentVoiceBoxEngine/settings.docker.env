# ==========================================================================
# AgentVoiceBox Django Environment Configuration (Docker)
# ==========================================================================
# Keep this file aligned with backend/.env.example

# ==========================================================================
# DJANGO CORE
# ==========================================================================
DJANGO_SECRET_KEY=your-secret-key-at-least-50-characters-long-for-security
DJANGO_DEBUG=false
DJANGO_ALLOWED_HOSTS=backend,localhost,127.0.0.1
DJANGO_SETTINGS_MODULE=config.settings.development
VOICE_AGENT_BASE_URL=http://localhost:65020
VOICE_AGENT_WS_BASE_URL=ws://localhost:65020
NODE_ENV=production

# ==========================================================================
# DATABASE (PostgreSQL)
# ==========================================================================
DB_HOST=postgres
DB_PORT=5432
DB_NAME=agentvoicebox
DB_USER=agentvoicebox
DB_PASSWORD=your-database-password
DB_CONN_MAX_AGE=60

# ==========================================================================
# REDIS
# ==========================================================================
REDIS_URL=redis://redis:6379/0
REDIS_CACHE_DB=1
REDIS_SESSION_DB=2
REDIS_CHANNEL_DB=3

# ==========================================================================
# KEYCLOAK
# ==========================================================================
KEYCLOAK_URL=http://keycloak:8080
KEYCLOAK_REALM=agentvoicebox
KEYCLOAK_CLIENT_ID=agentvoicebox-backend
KEYCLOAK_CLIENT_SECRET=your-keycloak-client-secret
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=change-me
KEYCLOAK_API_CLIENT_SECRET=change-me
KEYCLOAK_PASSWORD_SAAS_ADMIN=change-me
KEYCLOAK_PASSWORD_TENANT_ADMIN=change-me
KEYCLOAK_PASSWORD_AGENT_ADMIN=change-me
KEYCLOAK_PASSWORD_SUPERVISOR=change-me
KEYCLOAK_PASSWORD_OPERATOR=change-me
KEYCLOAK_PASSWORD_AGENT_DEV=change-me
KEYCLOAK_PASSWORD_AGENT_DEMO=change-me
KEYCLOAK_PASSWORD_BILLING_ADMIN=change-me

# ==========================================================================
# TEMPORAL
# ==========================================================================
TEMPORAL_HOST=temporal:7233
TEMPORAL_NAMESPACE=agentvoicebox
TEMPORAL_TASK_QUEUE=default
TEMPORAL_DB=postgres12
TEMPORAL_DB_PORT=5432
TEMPORAL_POSTGRES_USER=shared_admin
TEMPORAL_POSTGRES_PWD=shared_secure_2024
TEMPORAL_POSTGRES_SEEDS=postgres
TEMPORAL_ENABLE_ES=false
TEMPORAL_ADDRESS=temporal:7233
TEMPORAL_SKIP_DEFAULT_NAMESPACE_CREATION=false

# ==========================================================================
# HASHICORP VAULT
# ==========================================================================
VAULT_ADDR=http://vault:8200
VAULT_TOKEN=your-vault-token
# For production, use AppRole instead of token:
# VAULT_ROLE_ID=your-role-id
# VAULT_SECRET_ID=your-secret-id
VAULT_MOUNT_POINT=secret
# Fail startup if Vault is unavailable (recommended for production)
VAULT_FAIL_FAST=true

# ==========================================================================
# OPA (Open Policy Agent)
# ==========================================================================
OPA_URL=http://opa:8181
OPA_DECISION_PATH=/v1/data/agentvoicebox/allow
OPA_TIMEOUT_SECONDS=3
OPA_ENABLED=true

# ==========================================================================
# KAFKA
# ==========================================================================
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_CONSUMER_GROUP=agentvoicebox-backend
KAFKA_ENABLED=false
KAFKA_SECURITY_PROTOCOL=PLAINTEXT

# ==========================================================================
# LAGO BILLING
# ==========================================================================
LAGO_API_URL=http://lago:3000
LAGO_API_KEY=your-lago-api-key
LAGO_WEBHOOK_SECRET=your-lago-webhook-secret

# ==========================================================================
# OBSERVABILITY
# ==========================================================================
LOG_LEVEL=INFO
LOG_FORMAT=console
# SENTRY_DSN=https://your-sentry-dsn
PROMETHEUS_ENABLED=true

# ==========================================================================
# LLM PROVIDERS
# ==========================================================================
GROQ_API_KEY=
GROQ_API_BASE=https://api.groq.com/openai/v1
OPENAI_API_KEY=
OPENAI_API_BASE=https://api.openai.com/v1
OLLAMA_BASE_URL=http://ollama:11434

# ==========================================================================
# LLM DEFAULTS
# ==========================================================================
LLM_DEFAULT_PROVIDER=groq
LLM_DEFAULT_MODEL=llama-3.1-70b-versatile
LLM_MAX_TOKENS=1024
LLM_TEMPERATURE=0.7
LLM_CIRCUIT_BREAKER_THRESHOLD=5
LLM_CIRCUIT_BREAKER_TIMEOUT=30
LLM_MAX_HISTORY_ITEMS=40
LLM_PROVIDER_PRIORITY=groq,openai,ollama

# ==========================================================================
# CORS
# ==========================================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOW_CREDENTIALS=true

# ==========================================================================
# PORTAL FRONTEND
# ==========================================================================
VITE_API_URL=http://localhost:65000
VITE_KEYCLOAK_URL=http://localhost:65006
VITE_KEYCLOAK_REALM=agentvoicebox
VITE_KEYCLOAK_CLIENT_ID=agentvoicebox-portal
VITE_GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
VITE_AUTH_REDIRECT_URI=http://localhost:65013/auth/callback
GOOGLE_CLIENT_ID=your-google-client-id
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# ==========================================================================
# RATE LIMITING
# ==========================================================================
RATE_LIMIT_DEFAULT=60
RATE_LIMIT_API_KEY=120
RATE_LIMIT_ADMIN=300
REALTIME_REQUESTS_PER_MINUTE=100
REALTIME_TOKENS_PER_MINUTE=10000
REALTIME_RATE_LIMIT_WINDOW_SECONDS=60

# ==========================================================================
# REDIS WORKER CONNECTIONS
# ==========================================================================
REDIS_MAX_CONNECTIONS=200
REDIS_SOCKET_TIMEOUT=5.0
REDIS_SOCKET_CONNECT_TIMEOUT=5.0
REDIS_RETRY_ON_TIMEOUT=true
REDIS_HEALTH_CHECK_INTERVAL=30

# ==========================================================================
# WORKER STREAMS
# ==========================================================================
LLM_STREAM_REQUESTS=llm:requests
LLM_GROUP_WORKERS=llm-workers
LLM_RESPONSE_CHANNEL=llm:response
STT_STREAM_AUDIO=audio:stt
STT_GROUP_WORKERS=stt-workers
STT_CHANNEL_TRANSCRIPTION=transcription
TTS_STREAM_REQUESTS=tts:requests
TTS_GROUP_WORKERS=tts-workers
TTS_CHANNEL_TTS=tts
TTS_CHANNEL_AUDIO_OUT=audio:out

# ==========================================================================
# STT
# ==========================================================================
STT_MODEL=base
STT_DEVICE=auto
STT_COMPUTE_TYPE=float16
STT_BATCH_SIZE=4
STT_SAMPLE_RATE=16000

# ==========================================================================
# TTS
# ==========================================================================
TTS_MODEL_DIR=/app/cache/kokoro
TTS_MODEL_FILE=kokoro-v1.0.onnx
TTS_VOICES_FILE=voices-v1.0.bin
TTS_DEFAULT_VOICE=am_onyx
TTS_DEFAULT_SPEED=1.1
TTS_CHUNK_SIZE=24000

# ==========================================================================
# SHARED SERVICES
# ==========================================================================
SHARED_DB_NAME=shared
SHARED_DB_USER=shared_admin
SHARED_DB_PASSWORD=shared_secure_2024
SHARED_DB_INIT_ARGS=--encoding=UTF8 --locale=en_US.UTF-8
